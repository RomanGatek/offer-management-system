<!DOCTYPE html>
<html lang="cs" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>GlobÃ¡lnÃ­ audit</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ddd; padding: 8px; vertical-align: top; }
    th { background: #f5f5f5; text-align: left; }
    tr:nth-child(even) { background: #fafafa; }
    .muted { color: #777; font-size: 12px; }
    .actions { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
  </style>
</head>
<body>

<h1>ğŸ“Š GlobÃ¡lnÃ­ audit</h1>

<form method="get" class="actions">

  <label>
    Section:
    <select name="section">
      <option value="">-- vÅ¡echny --</option>
      <option th:each="s : ${sections}"
              th:value="${s}"
              th:selected="${s == selectedSection}"
              th:text="${s}">
      </option>
    </select>
  </label>

  <label>
    Action:
    <select name="action">
      <option value="">-- vÅ¡echny --</option>
      <option th:each="a : ${actions}"
              th:value="${a}"
              th:selected="${a == selectedAction}"
              th:text="${a}">
      </option>
    </select>
  </label>

  <button type="submit">Filtrovat</button>

  <a th:href="@{/admin/audit/export(section=${selectedSection},action=${selectedAction})}">
    ğŸ“„ Export CSV
  </a>

  <a th:href="@{/admin/audit}">Reset</a>

</form>

<hr>

<table>
  <thead>
  <tr>
    <th style="width:180px;">ÄŒas</th>
    <th style="width:90px;">Offer</th>
    <th style="width:120px;">Section</th>
    <th style="width:150px;">Action</th>
    <th style="width:140px;">User</th>
    <th>Detail</th>
  </tr>
  </thead>

  <tbody>
  <tr th:each="log : ${logs.content}">
    <td th:text="${#temporals.format(log.performedAt,'dd.MM.yyyy HH:mm:ss')}"></td>

    <td>
      <span th:if="${log.offer != null}" th:text="${log.offer.id}"></span>
      <span th:if="${log.offer == null}" class="muted">â€”</span>
    </td>

    <td th:text="${log.section}"></td>
    <td th:text="${log.action}"></td>

    <td>
      <span th:if="${log.performedBy != null}" th:text="${log.performedBy.username}"></span>
      <span th:if="${log.performedBy == null}" class="muted">SYSTEM</span>
    </td>

    <td th:text="${log.detail}"></td>
  </tr>

  <tr th:if="${logs.totalElements == 0}">
    <td colspan="6" class="muted">Å½Ã¡dnÃ© auditnÃ­ zÃ¡znamy.</td>
  </tr>
  </tbody>
</table>

<br>

<div class="actions">
  <a th:if="${logs.hasPrevious()}"
     th:href="@{/admin/audit(page=${logs.number-1}, section=${selectedSection}, action=${selectedAction})}">
    â† PÅ™edchozÃ­
  </a>

  <span>Strana <b th:text="${logs.number + 1}"></b> / <span th:text="${logs.totalPages}"></span></span>

  <a th:if="${logs.hasNext()}"
     th:href="@{/admin/audit(page=${logs.number+1}, section=${selectedSection}, action=${selectedAction})}">
    DalÅ¡Ã­ â†’
  </a>
</div>

<br>
<a href="/admin">â† ZpÄ›t</a>

</body>
</html>